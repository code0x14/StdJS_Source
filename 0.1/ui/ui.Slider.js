Std.model("ui.Slider",{parent:"widget",events:"dragStart dragStop change",action:{content:"value"},option:{min:0,max:100,value:0,color:"#5FA8DB",defaultClass:"StdUI_Slider",handleWidth:18,handleHeight:18},extend:{init_boxSize:function(){var e=this;e.handleBoxSize=e.D.handle.boxSize()},render:function(){var e=this,t=e.opts;e.D.handle.css({width:t.handleWidth-e.handleBoxSize.width,height:t.handleHeight-e.handleBoxSize.height}),e.call_opts("color"),e.on("resize",e.refresh.bind(e)),e.refresh(),e.initDrag(),e.initEvents()}},"protected":{updateProgress:function(e){var t=this;switch(t._direction){case"horizontal":t.D.progress.width(e);break;case"vertical":t.D.progress.height(e)}return t},updateValue:function(e){var t=this,i=t.opts,n=0,o=0,a=0,r="",h=null,d=i.max-i.min,s=t._direction;return"horizontal"===s?(n=t.width(),r="left",o=t.boxSize.width,a=i.handleWidth,h=Math.round((n-o-a)/d*(e-i.min)),t.D.handle.css(r,h)):"vertical"===s&&(n=t.height(),r="top",o=t.boxSize.height,a=i.handleHeight,h=Math.round((n-o-a)/d*(e-i.min)),t.D.handle.css(r,(n-o-a)/d*(d-e-i.min))),t.updateProgress(h+a/2),t.emit("change",i.value=e)},initEvents:function(){var e=this,t=!1;return e[0].focussing(function(){this.addClass("focus"),t===!1&&(t=!0,e.initKeyboard())},function(){this.removeClass("focus")}),e},initKeyboard:function(){var e=this;return e.on("keydown",function(t){switch(t.keyCode){case 37:case 38:e.value(e.value()-1);break;case 39:case 40:e.value(e.value()+1)}})},initDrag:function(){var e,t,i,n=this,o=n.opts,a=0,r=0,h=function(){e=n[0].offset(),"horizontal"===n._direction?(t="pageX",i="x",r=o.handleWidth,a=n.width()-n.boxSize.width):"vertical"===n._direction&&(t="pageY",i="y",r=o.handleHeight,a=n.height()-n.boxSize.height)},d=function(h){var d=h[t]-e[i],s=0;"pageX"===t?s=o.min+Math.round((d-r/2)/(a-r)*(o.max-o.min)):"pageY"===t&&(s=o.min+Math.round((a-d-r/2)/(a-r)*(o.max-o.min))),n.value(s)};return n[0].mouse({down:function(e){1===e.which&&(h(),Std.dom(document).on("mousemove",d(e)||d),e.preventDefault(),n.emit("dragStart"))},up:function(){Std.dom(document).off("mousemove",d),n.emit("dragStop")}}),n}},"public":{refresh:function(){return this.value(this.opts.value)},min:function(e){return this.opt("min",e,function(){this.refresh()})},max:function(e){return this.opt("max",e,function(){this.refresh()})},color:function(e){return this.opt("color",e,function(){this.D.progress.css("background",e)})},range:function(e,t){var i=this,n=i.opts;return void 0===e?{min:n.min,max:n.max}:(n.min=e,n.max=t,i)},value:function(e){var t=this,i=t.opts;return void 0===e?i.value:((e=int(e))<i.min?e=i.min:e>i.max&&(e=i.max),t.updateValue(e),t)}},main:function(e,t,i){var n=e.D={};i.addClass("_"+e._direction).append([n.client=newDiv("_client").append(n.progress=newDiv("_progress")),n.handle=newDiv("_handle").attr("tabindex",1)])}}),Std.ui.module("HSlider",{model:"ui.Slider",option:{level:3,height:22},"private":{direction:"horizontal"},extend:{height:function(){var e=this,t=e.opts,i=e.D,n=e.height();if(e.handleBoxSize){var o=t.handleHeight-e.handleBoxSize.height;i.handle.css({top:(n-o)/2})}i.client.css("top",Math.round((n-i.client.height())/2))}}}),Std.ui.module("VSlider",{model:"ui.Slider",option:{level:3,width:22,height:200},"private":{direction:"vertical"},extend:{width:function(){var e=this,t=e.opts,i=e.D,n=e.width();if(e.handleBoxSize){var o=t.handleWidth-e.handleBoxSize.width;i.handle.css({left:(n-o)/2})}i.client.css("left",Math.round((n-i.client.width())/2))}}});