Std.ui.module("ToolTip",{parent:"widget",option:{level:2,defaultClass:"StdUI_ToolTip",value:null,renderTo:"body",align:"center",position:"top",x:0,y:0,iframe:null,html:null,url:null,selector:null,target:null,tabIndex:null,padding:12},extend:{visible:function(t){t===!0&&this[0].css("zIndex",Std.ui.status.zIndex+1)},render:function(){this.initEvents(),this.call_opts({selector:null},!0),this[0].css("zIndex",Std.ui.status.zIndex+1)}},"protected":{height:function(t){this[1].outerHeight(t)},width:function(t){this[1].outerWidth(t)},initEvents:function(){var t=this;return t.on("load",t.relocate),t},computeXY:function(t,i,e,o){var n=this,r=Std.dom(n.target()),l=n.position();if(null==r)return{x:0,y:0};var u=0,s=0,a=r.offsetHeight(),c=r.offsetWidth(),h=r.offset();return"top"==l?(u=h.x+(c-t)/2,s=h.y-(i+o)):"bottom"==l?(u=h.x+(c-t)/2,s=h.y+a+o):"right"==l?(u=h.x+c+e,s=h.y+(a-i)/2):"left"==l&&(u=h.x-e-t,s=h.y+(a-i)/2),{x:u,y:s}},relocate:function(){var t=this,i=t.position(),e=t[1].offsetWidth(),o=t[1].offsetHeight(),n=t[2].offsetWidth(),r=t[2].offsetHeight();switch(i){case"top":case"bottom":t[2].css("left",(e-n)/2);break;case"right":case"left":t[2].css("top",(o-r)/2)}if(t.target()){var l=t.computeXY(e,o,n,r);t.move(l.x,l.y)}return t}},"public":{target:function(t){return this.opt("target",t)},x:function(t){return this.opt("x",t,function(){this[0].css("left",t)})},y:function(t){return this.opt("y",t,function(){this[0].css("top",t)})},align:function(t){return this.opt("align",t,function(){this.renderState&&this.relocate()})},position:function(t){var i=this;return i.opt("position",t,function(){i[2].className("_pointer _"+t),i.renderState&&i.relocate()})},padding:function(t){var i=this;return this.opt("padding",t,function(){i[1]&&i[1].css("padding",t),i.renderState&&i.relocate()})},selector:function(t){var i=this;return this.opt("selector",t,function(){var e=Std.dom(t);if(null!==e){var o=e.html();i[1].html(o),i.emit("load",o)}})},iframe:function(t){var i=this;return i.opt("iframe",t,function(){i[1].clear().append(newDom("iframe").attr({src:t,frameBorder:0}).on("load",function(){i.emit("load")})),i.relocate()})},html:function(t){var i=this;return i.opt("html",t,function(){i[1].html(t),i.emit("load",t)})},url:function(t){var i=this;return i.opt("url",t,function(){var e=newDiv("_loading");i[1].append(e),e.css("marginTop",(i[1].height()-e.height())/2),i.relocate(),Std.ajax({url:t,cache:!0,success:function(t){i.html(t)}})})}},main:function(t){t[0].append([t[1]=newDiv("_client"),t[2]=newDiv("_pointer")]),t.call_opts(["x","y","padding","position"])}}),Std.plugin.module("ToolTip",{option:{triggerMode:"mouseenter",timeout:200,delegate:null,width:"auto",height:"auto",position:"top"},"protected":{createWidget:function(){var t=this,i=t.opts,e={on:{load:function(i){t.emit("load",i)}}};return Std.each("className position width height padding renderTo url html iframe selector",function(t,o){o in i&&(e[o]=i[o])}),t._tooltip=Std.ui("ToolTip",e),t},initToolTip:function(){var t=this;return t._tooltip||t.createWidget(),t},removeToolTip:function(){var t=this,i=t._tooltip;return i&&i.remove(),t._tooltip=null,t},remove:function(){var t=this;return null!==t._timer&&(clearTimeout(t._timer),t._timer=null),t.removeToolTip(),t}},"public":{iframe:function(t){return this.opt("iframe",t,function(){this._tooltip&&this._tooltip.iframe(t)})},html:function(t){return this.opt("html",t,function(){this._tooltip&&this._tooltip.html(t)})},url:function(t){return this.opt("url",t,function(){this._tooltip&&this._tooltip.url(t)})},selector:function(t){return this.opt("selector",t,function(){this._tooltip&&this._tooltip.selector(t)})},target:function(t){var i=this,e=i._tooltip;return void 0===t?e.target():(e.target(t),i)},clearTimer:function(){var t=this;return null!==t._timer&&(clearTimeout(t._timer),t._timer=null),t}},main:function(t,i,e){t._timer=null;var o=function(e){var o=this;this.mouse({auto:!1,enter:function(){t.clearTimer(),t._timer=setTimeout(function(){t._tooltip||t.initToolTip(),t.target(o).emit("render",o),t._tooltip.relocate()},i.timeout)},leave:function(){t.clearTimer().removeToolTip()}},e)};isString(i.delegate)?Std.dom(e).on(i.triggerMode,i.delegate,o):Std.dom(e).on(i.triggerMode,o)}});