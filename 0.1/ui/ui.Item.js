Std.ui.module("Item",{parent:"widget",action:{content:"text"},option:{level:2,defaultClass:"StdUI_Item",text:"",icon:null,value:null,tabIndex:null,iconClass:null,iconWidth:null,iconHeight:null,verticalAlign:"top"},"private":{textVisible:!0},extend:{beforeRender:function(){this.call_opts({text:"",value:null,icon:null,iconClass:null},!0)},width:function(){var t=this,e=t.opts,i=t.D,n=t.width();isNumber(e.iconWidth)&&i.icon&&n-t.boxSize.width<=e.iconWidth?t._textVisible&&i.text&&(i.text.hide(),t._textVisible=!1):!t._textVisible&&i.text&&(i.text.show(),t._textVisible=!0)},height:function(){var t=this,e=t.opts,i=e.verticalAlign;if("top"!==i&&"none"!==i){var n=t.D,o=t.height()-t.boxSize.height,l=0,c=0;"middle"===i?(isNumber(e.iconHeight)&&(l=(o-e.iconHeight)/2),c=o):"bottom"===i&&(isNumber(e.iconHeight)&&(l=o-e.iconHeight),c=2*o),n.icon&&isNumber(e.iconHeight)&&n.icon.marginTop(l),n.text&&n.text.lineHeight(c)}}},"protected":{initIcon:function(){var t=this,e=t.D,i=e.icon=newDiv("_icon");return e.text?i.insertBefore(e.text):i.appendTo(t[0]),t.call_opts({iconWidth:null,iconHeight:null},!0)}},"public":{verticalAlign:function(t){return this.opt("verticalAlign",t)},iconWidth:function(t){var e=this;return e.opt("iconWidth",t,function(){e.D.icon&&e.D.icon.width(t)})},iconHeight:function(t){var e=this;return e.opt("iconHeight",t,function(){e.D.icon&&e.D.icon.height(t)})},iconClass:function(t){var e=this,i=e.D;return e.opt("iconClass",t,function(){i.icon||e.initIcon(),i.icon.className("_icon "+t)})},text:function(t){var e=this;return e.opt("text",t,function(){e.D.text||(e.D.text=newDiv("_text").appendTo(e[0])),e.D.text.html(t)})},icon:function(t){var e=this,i=e.D;return e.opt("icon",t,function(){i.icon||e.initIcon(),i.iconImg||(i.iconImg=newDom("img").appendTo(i.icon)),i.iconImg.attr("src",t)})},edit:function(t){if(!this._editState){var e=this,i=e.D,n=i.text.html(),o=null,l=newDom("input","_edit"),c=newDom("span").css({top:-99,font:i.text.css("font"),fontSize:i.text.css("fontSize"),position:"absolute",visibility:"hidden",padding:l.css("padding")}).text(n).appendTo(e[0]);l.on({mousedown:function(t){t.stopPropagation()},keydown:function(t){13===t.keyCode?l.blur():(clearTimeout(o),o=setTimeout(function(){l.width(c.text(l.value()).width())},1))},blur:function(){var o=l.value();i.text.show(),isFunction(t)&&t.call(e.text(o),n,o),l.remove(),e._editState=!1}}).appendTo(e).focus().css({"float":i.text.css("float"),width:c.width(),height:i.text.height()}).value(n).select(),i.text.hide(),e._editState=!0}}},main:function(t,e,i){t.D={},isFunction(e.click)&&i.on("click",function(){t.enable()&&e.click.call(t)})}}),Std.ui.module("TemplateItem",{parent:"widget",events:"templateRender",action:{content:"text"},option:{level:2,defaultClass:"StdUI_TemplateItem",text:"",data:null,value:null,tabIndex:null,template:null,textField:"text",valueField:"value"},extend:{render:function(){var t=this;t.call_opts({data:null},!0)}},"public":{text:function(t){return this.opt("text",t)},template:function(t){var e=this,i=e.opts;return e.opt("template",t,function(){isString(t)?i.template=Std.template(t):t instanceof Std.template&&(i.template=t)})},data:function(t){var e=this,i=e.opts;if(void 0===t)return i.data;var n=e.template();return(isString(t)||isNumber(t))&&(t={value:t}),isObject(n)&&(n.renderTo(e,t),e.emit("templateRender")),e.text(t[i.textField]),e.value(t[i.valueField]),i.data=t,e}},main:function(t,e,i){t.D={},e.template&&t.template(e.template),isFunction(e.click)&&i.on("click",function(){t.enable()&&e.click.call(t)})}});