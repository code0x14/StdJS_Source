Std.ui.module("Window",{parent:"Panel",events:"minimize maximize restore close",action:{content:"html"},option:{defaultClass:"StdUI_Panel StdUI_Window",minWidth:180,minHeight:100,width:600,height:400,resizable:!0,draggable:!0,minimizable:!0,maximizable:!0,closable:!0,center:!0,modal:!1,minimize:!1,maximize:!1,title:"Window",renderTo:"body",closeAction:"remove"},"private":{locker:null,lastRect:null,windowResize:null},extend:{render:function(){var i=this,e=i.opts;e.center&&i.move("center"),e.modal&&i.initLocker(),i.call_opts({maximize:!1,resizable:!1,draggable:!1},!0),i.focus(1)},titleButtonClick:function(i){var e=this;switch(i){case"min":e.minimize(!0);break;case"max":e.maximize(!e.opts.maximize);break;case"close":e.close()}return e},visible:function(i){var e=this,t=e._locker;t&&t.visible(i)},remove:function(){var i=this;i._locker&&i._locker.remove(),i._windowResize&&Std.dom(window).off("resize",i._windowResize)}},"protected":{initLocker:function(){var i=this;i._locker=Std.ui("locker",{renderTo:i[0].parent(),opacity:.1,visible:!0})},initWindowEvent:function(){var i=this,e=i[0].offsetParent();return e.contains("body")&&(e=Std.dom(window)),Std.dom(window).on("resize",i._windowResize=function(){i.move(0,0).size(e.outerWidth(),e.outerHeight())}),i},initTitleButtons:function(){var i=this,e=i.opts;return i.appendTitleButton({min:"_min",max:"_max",close:"_close"}),i.D.TitleBar.on({dblclick:function(){e.maximizable&&i.maximize(!e.maximize)}}),i},initTitleContextMenu:function(){var i=this,e=i.opts,t=[{text:"Restore",iconClass:"_restore",click:function(){i.restore()}},{text:"Minimize",iconClass:"_min",enable:e.minimizable,click:function(){i.minimize(!0)}},{ui:"MenuItem",text:"Maximize",iconClass:"_max",enable:e.maximizable,click:function(){i.maximize(!0)}},{ui:"sep"},{text:"Hide Window",click:function(){i.hide()}},{ui:"MenuItem",text:"Move To",enable:!1,items:[{text:"center"}]},{ui:"sep"},{text:"Close",iconClass:"_close",css:{fontWeight:"bold"},enable:e.closable,click:function(){i.close()}}];i.plugin("contextMenu",{width:160,items:t,handle:i.D.TitleBar,on:{show:function(){var t=this.menu.items;t[0].enable(i._lastRect),t[2].enable(!i.maximize()),t[7].enable(e.closable)}}})},saveRect:function(){var i=this;return i._lastRect={top:i[0].css("top"),left:i[0].css("left"),width:i.width(),height:i.height()}}},"public":{minimizable:function(i){var e=this;return e.opt("minimizable",i,function(){e.titleButtons("min").visible(i)})},maximizable:function(i){var e=this;return e.opt("maximizable",i,function(){e.titleButtons("max").visible(i)})},closable:function(i){var e=this;return e.opt("closable",i,function(){e.titleButtons("close").visible(i)})},resizable:function(i){var e=this;return e.opt("resizable",i,function(){e.plugin("resize")||e.plugin("resize",{on:{stop:function(){}}}),e.plugin("resize").resizable(i)})},draggable:function(i){var e=this;return e.opt("draggable",i,function(){e.plugin("drag")||(e.plugin("drag",{handle:e.D.TitleBar}),e.plugin("drag").on({start:function(){e.D.Client.css("visibility","hidden")},stop:function(){e.D.Client.removeStyle("visibility")}})),e.plugin("drag").draggable(i)})},close:function(){var i=this,e=i.opts.closeAction;return e in i&&i.animation("close",function(){i[e]()},e),i.emit("close")},minimize:function(i){var e=this;return e.opt("minimize",i,function(){e.emit("minimize",i),e.animation("minimize",function(){e.visible(!i)},i)})},maximize:function(i){var e=this;return e.opt("maximize",i,function(){i===!1?e.restore():(e.titleButtons("max").addClass("_restore"),e._windowResize||e.initWindowEvent(),e.animation("maximize",function(){e._windowResize()},e.saveRect())),e.emit("maximize",i)})},restore:function(){var i=this,e=i._lastRect;return i.opts.maximize=!1,i.titleButtons("max").removeClass("_restore"),null!==e&&i.animation("restore",function(){i.width(e.width),i.height(e.height),i[0].css({top:e.top,left:e.left})},e),i._windowResize&&Std.dom(window).off("resize",i._windowResize),i.emit("restore")}},main:function(i,e,t){t.focussing(function(){i.toForeground()},null,!1),i.initTitleContextMenu(),i.initTitleButtons(),i.call_opts({minimizable:!0,maximizable:!0,closable:!0},!0)}});