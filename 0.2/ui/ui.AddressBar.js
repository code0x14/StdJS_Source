/**
  * Std UI Kit Library
  * http://ui.stdjs.com
  * module: AddressBar
*/
Std.ui.module("AddressBar",{b:"widget",c:"change iconClick",e:{level:3,defaultClass:"StdUI_AddressBar",editable:!0,type:"toggle",border:"auto",status:"none",value:"",sep:"/",icon:null,iconWidth:18,iconHeight:18},g:{render:function(){var t=this,n=t.DOMMap;n.paths&&t.updatePaths(),n.input&&n.input.value(value),t.initEvents()},height:function(t){var n=this;isNumber(t)||(t=n.height()),t-=n.boxSize.height+n.boxSize.extraHeight,n[0].lineHeight(t),n.DOMMap.input&&n.DOMMap.input.lineHeight(t)}},n:{initDOMTree:function(){var t=this,n=t.DOMMap={table:newDom("table")};n.table.append(n.tbody=newDom("tbody").append(n.tr=newDom("tr"))).appendTo(t[0])},initIcon:function(){var t=this,n=t.DOMMap;return n.iconTD=newDom("td").append(n.icon=newDiv("_icon").on("click",function(n){t.emit("iconClick",n)})).prependTo(n.tr),t.call_opts({iconWidth:null,iconHeight:null},!0)},initPaths:function(){var t=this,n=t.DOMMap;n.pathsTD=newDom("td").append(n.paths=newDiv("_paths")).appendTo(n.tr),n.paths.on("mouseenter","> ._path",function(n){this.mouse({auto:!1,click:function(n){var e=this.data("path");this.hasClass("_icon")||t.value(e),n.stopPropagation()}},n)})},initComboBox:function(){var t=this,n=t.opts;t.DOMMap.comboBox=newDiv("_comboBox").attr("tabIndex",1).append(t.DOMMap.input=newDom("input","_input").on("keydown[return]",function(){"toggle"===n.type&&t.status("none"),t.value(this.value()),t[0].focus()}).lineHeight(t.height()-t.boxSize.height-t.boxSize.extraHeight)).appendTo(t.DOMMap.pathsTD)},initComboBoxList:function(){},initPathsList:function(){},initEvents:function(){var t=this,n=t.opts;t[0].focussing(function(){t.addClass("focused")},function(){t.removeClass("focused")}),t[0].on("mouseenter",function(e){this.mouse({auto:!1,click:function(){"none"===t.status()&&"toggle"===n.type&&t.status("edit")}},e)})}},i:{parsePath:function(t){for(var n=this,e=n.opts,i="",o=0,a=e.sep,p="",s=[],h=t.length;h>o;o++){var u=t.charAt(o);":"===u&&t.charAt(o+1)==a&&0==s.length?(i=p,p="",o++):u===a?""!==p&&(s.push(p),p=""):p+=u}return""!==p&&s.push(p),{protocol:i,paths:s}},updatePaths:function(){var t=this.clearPath(),n=t.opts,e=t.parsePath(t.value()),i="";return e.protocol&&(i=e.protocol+":"+n.sep),Std.each(e.paths,function(o,a){i+=n.sep+a,newDom("a","_path").data("path",i).append(newDiv("_text").html(a)).appendTo(t.DOMMap.paths),o<e.paths.length-1&&newDom("a","_path _icon").data("path",i).append(newDiv("_icon")).appendTo(t.DOMMap.paths)}),t},clearPath:function(){var t=this,n=t.DOMMap;return n.paths.clear(),t._paths.clear(),t}},j:{editable:function(t){return this.opt("editable",t,function(){this[0].css("cursor",t?"text":"")})},type:function(t){var n=this,e=n.DOMMap;return this.opt("type",t,function(i){i!==t&&("edit"===t?(n.initComboBox(),e.paths&&e.paths.detach()):"path"===t&&(n.initPaths(),e.comboBox&&e.comboBox.detach()),n.resize("height"))})},status:function(t){var n=this,e=n.opts,i=n.DOMMap;return n.opt("status",t,function(){"edit"===t&&this.editable()?(n.initComboBox(),i.comboBox.appendTo(i.pathsTD),i.paths.detach(),i.input.focus().value(n.value()),"auto"===e.border&&n.addClass("_border")):"none"===t&&(i.comboBox&&i.comboBox.detach(),i.pathsTD.append(i.paths),"auto"===e.border&&n.removeClass("_border"))})},icon:function(t){var n=this,e=n.DOMMap;return n.opt("icon",t,function(i){n.initIcon(),Std.icon.update(e.icon,t,{width:null,height:null}),n.rendered&&t!==i&&n.emit("iconChange",t)})},iconWidth:function(t){var n=this;return n.opt("iconWidth",t,function(){n.DOMMap.icon&&Std.icon.update(n.DOMMap.icon,{width:t}),isNumber(t)&&n.DOMMap.iconTD.width(t+6)})},iconHeight:function(t){var n=this;return n.opt("iconHeight",t,function(){n.DOMMap.icon&&Std.icon.update(n.DOMMap.icon,{height:t})})},value:function(t){var n=this;return n.opt("value",t,function(e){n.rendered&&t!==e&&(n.DOMMap.paths&&n.updatePaths(),n.DOMMap.input&&n.DOMMap.input.value(t),n.emit("change",t))})}},k:function(t,n){t._paths=[],t.initDOMTree(),t.call_opts({icon:null,editable:!1},!0),"edit"===n.type?t.addClass("_border").initComboBox():("path"===n.type||"toggle"===n.type)&&t.initPaths(),n.border===!0&&t.addClass("_border")}});