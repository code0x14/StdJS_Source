/**
    Std UI Kit Library
    http://ui.stdjs.com
	module: MessageBox
	fixme:type:error,IE css 兼容性未处理
*/
Std.ui.module("MessageBox",{b:"widget",c:"ok cancel close yes no abort retry ignore disagree apply buttonClick",e:{level:1,defaultClass:"StdUI_MessageBox",renderTo:"body",type:"information",acceptEsc:!0,closable:!0,draggable:!0,title:null,value:null,icon:!0,text:"null",timeout:0,buttons:"ok",buttonsAlign:"right",inputType:null,inputWidth:"auto",inputHeight:"auto",detailedText:"",defaultButton:"ok",informativeText:null,tabIndex:9},h:{hasIcon:!1,hasDetail:!1,hasInformativeText:!1},f:{create:function(t,n,e,i){var o={type:t,renderTo:"body"};return isObject(n)?Std.extend(o,n):isString(n)&&(o.text=n,isString(e)&&(o.title=e),isFunction(i)?o.on("ok",i):i&&(o.buttons=i)),Std.ui("MessageBox",o)},information:function(t,n,e){return this.create("information",t,n,e)},warning:function(t,n,e){return this.create("warning",t,n,e)},success:function(t,n,e){return this.create("success",t,n,e)},error:function(t,n,e){return this.create("error",t,n,e)},question:function(t,n,e){return this.create("question",t,n,e)},confirm:function(t,n,e){var i=this.question({text:t,title:isString(n)?n:"confirm",buttons:"cancel ok"});return isFunction(e)&&i.on("ok",e),i},prompt:function(t,n,e,i){return this.create("information",{inputType:"LineEdit",value:n,title:isString(e)?e:"prompt",text:t,on:{ok:function(){isFunction(i)&&i.call(this,this.value())}}})}},g:{render:function(){var t=this,n=t.opts;t.initLocker(),t[0].css("zIndex",++Std.ui.status.zIndex),null!==t.input?(t.input.renderTo(t.DOMMap.BodyClientContentInput),t.input.focus(100)):n.defaultButton?t.defaultButton(n.defaultButton):t.focus(),t.updateLayout(),t.move("central")},destroy:function(){var t=this,n=t._locker;n&&n.remove(),Std.dom(window).off("keyup",t._keyupHandle)}},i:{input:null,initIcon:function(){var t=this;return t.DOMMap.BodyClient.prepend(t.DOMMap.BodyClientIcon=newDiv("_icon _default")),t},initKeyboard:function(){var t=this,n=t.opts;return Std.dom(window).on("keyup",t._keyupHandle||(t._keyupHandle=function(e){var i=Std.dom(e.target),o=e.keyCode;if(27===o&&n.acceptEsc)t.destroy();else if(39===o);else if(40===o);else if((13==o||32==o)&&i.hasClass("_button")){var u=t._buttons[t._defaultButton];u&&u.emit("click")}})),t},initEvents:function(){var t=this,n=!1;t[0].on("mousedown",function(t){t.stopPropagation()}).focussing(function(){n===!1&&(n=!0,t.initKeyboard()),t[0].css("zIndex",++Std.ui.status.zIndex)},null,!1)},initLocker:function(){var t=this,n="black",e=.1,i=t[0].offsetParent();switch(t.opts.type){case"warning":n="#FF8142",e=.6;break;case"error":n="#FF0505",e=.3;break;case"question":n="#4692D7",e=.2;break;case"success":n="#0CF4AB"}return t._locker=Std.ui("locker",{renderTo:i.contains("body")?"body":i,opacity:e,visible:!0,background:n}),t}},j:{title:function(t){return this.opt("title",t,function(){this.DOMMap.TitleText.html(t)})},text:function(t){return this.opt("text",t,function(){this.DOMMap.BodyClientContentText.html(t)})},timeout:function(t){var n=this;return n.opt("timeout",t,function(){Std.func(function(){n.remove()},{delay:t})()})},updateLayout:function(){var t=this,n=t.opts,e=t.DOMMap;if("left"!=n.buttonsAlign){var i=e.Buttons.offsetWidth()-e.ButtonGroup.offsetWidth()-2;("warning"==n.type||"center"==n.buttonsAlign)&&(i/=2),e.ButtonSpacing.width(i)}},icon:function(t){var n=this;return n.opt("icon",t,function(){n.DOMMap.BodyClientIcon||n.initIcon(),Std.icon.update(n.DOMMap.BodyClientIcon.removeClass("_default"),t,{width:null,height:null})})},value:function(t){var n=this,e=n.opts,i=n.input;return void 0===t?i?i.value():e.value:(i&&i.value(t),e.value=t,n)},informativeText:function(t){var n=this;return n.opt("informativeText",t,function(){n._hasInformativeText||(n._hasInformativeText=!0,n.DOMMap.BodyClientContent.prepend(n.DOMMap.InformativeText=newDiv("_informativeText"))),n.DOMMap.InformativeText.html(t)})},inputType:function(t){var n=this;return n.opt("inputType",t,function(){null!==n.input&&n.input.remove(),n.input=Std.ui(t,{width:n.opts.inputWidth,height:n.opts.inputHeight}),n.input&&null!==n.value()&&n.input.value(n.value())})},buttons:function(t,n){var e=this,i=function(t,n){e._buttons[t]&&e._buttons[t].remove();var i=newDiv("_button").mouse({unselect:!0}).html(n.toUpperCase()).attr({tabindex:0,buttonName:t}).on("click",function(){e.emit(t),e.emit("buttonClick",t),e.remove()});e.DOMMap.ButtonGroup.append(e._buttons[t]=i)};isString(t)&&(void 0===n?t=t.split(" "):isString(n)&&i(t,n)),isArray(t)?Std.each(t,function(t,n){i(n,n)}):isObject(t)&&Std.each(t,function(t,n){i(t,n)})},defaultButton:function(t){var n=this;if(void 0==t)return n._defaultButton;var e=n._buttons[n._defaultButton=t];return e&&e.focus(),n},detailedText:function(t){var n=this,e=n.DOMMap;return void 0==t?e.Detail.html():(n._hasDetail||(n._hasDetail=!0,e.Body.append(e.Detail=newDiv("_detail"))),e.Detail.html(t),n)},closable:function(t){var n=this,e=n.DOMMap;return n.opt("closable",t,function(){e.TitleButtons_Close&&e.TitleButtons_Close.remove(),t!==!1&&e.TitleButtons.append(e.TitleButtons_Close=newDiv("_button _close").mouse({down:function(){return!1},click:function(){n.remove()}}))})},draggable:function(t){var n=this;return n.opt("draggable",t,function(){n.plugin("drag")||n.plugin("drag",{handle:n.DOMMap.Title}),n.plugin("drag").draggable(t)})}},k:function(t,n,e){t._buttons=[];var i=t.DOMMap={Title:newDiv("_title"),TitleText:newDiv("_text"),TitleButtons:newDiv("_buttons"),Body:newDiv("_body"),BodyClient:newDiv("_client"),BodyClientContent:newDiv("_content"),BodyClientContentText:newDiv("_text"),BodyClientContentInput:newDiv("_input"),Buttons:newDiv("_buttons"),ButtonSpacing:newDiv("_buttonSpacing"),ButtonGroup:newDiv("_buttonGroup")};i.Title.append([i.TitleText,i.TitleButtons]),i.Body.append([i.BodyClient,i.Buttons.append([i.ButtonSpacing,i.ButtonGroup]),i.Detail]),i.BodyClient.append(i.BodyClientContent),i.BodyClientContent.append([i.BodyClientContentText,i.BodyClientContentInput]),e.append([i.Title,i.Body]),t.title(null===n.title?n.type:n.title),"none"!==n.type&&e.addClass("-"+n.type),n.icon!==!1&&t.initIcon(),isBool(n.icon)||t.icon(n.icon),null===n.informativeText&&"warning"==n.type&&(n.informativeText="warning"),t.call_opts({text:"",buttons:"",timeout:0,draggable:!1,closable:!1,inputType:null,detailedText:"",informativeText:null},!0),t.initEvents()}});