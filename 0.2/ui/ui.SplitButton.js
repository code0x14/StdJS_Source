/**
    Std UI Kit Library
    http://ui.stdjs.com
	module: SplitButton,SplitToolButton
*/
Std.ui.module("SplitButton",{b:"widget",c:"mousedown mouseup click press longpress focus blur open close",e:{level:2,defaultClass:"StdUI_SplitButton",text:"SplitButton",tabIndex:null,icon:null,iconWidth:18,iconHeight:18,href:"",target:"_blank",theme:"default",styleType:"text",minWidth:30,minHeight:20,dropdown:null,buttonType:"Button"},h:{timer:null},g:{beforeRender:function(){this._group.render()},render:function(){var t=this;t._dropdown&&t._dropdown.render()},destroy:function(){var t=this;isObject(t._dropdown)&&t._dropdown.remove(),t._timer&&clearTimeout(t._timer),t._closeit&&Std.dom(document).off("click",t._closeit)},width:function(t){var e=this;isNumber(t)||(t=e.width()),e._button.width(t-e._handle.width())},height:function(t){isNumber(t)&&this._group.height(t)}},j:{theme:function(t){var e=this;return this.opt("theme",t,function(){e._button.theme(t),e._handle.theme(t),e._handle.DOMMap.icon.className("_handleIcon --"+t)})},enable:function(t){var e=this;return e.opt("enable",t,function(){e._button.enable(t),e._handle.enable(t)})},open:function(){var t=this,e=t._dropdown;if(t._closeit||(t._closeit=function(n){n&&!Std.dom(e).contains(n.target)&&t.close()}),e&&!e.visible()){var n=t[0].offset();e.visible(!0),e.move(n.x+t.width()+t[0].marginLeft()-e.width(),n.y+t.height()+1),t.addClass("checked"),t.emit("open"),t._timer=setTimeout(function(){Std.dom(document).on("click",t._closeit)},1)}return t},close:function(){var t=this,e=t._dropdown;return t._closeit&&Std.dom(document).off("click",t._closeit),e&&e.visible()&&(e.hide(),t.removeClass("checked"),t.emit("close")),t},dropdown:function(t){var e=this;return void 0===t?e._dropdown||null:(isWidget(t)?e._dropdown=t:isObject(t)&&(e._dropdown=Std.ui(t.ui||"Menu",t)),isWidget(e._dropdown)&&(e._dropdown.visible(!1).on("visible",function(t){e._handle.checked(t)}),e._dropdown[0].css({position:"absolute",margin:0}).appendTo("body"),e._dropdown instanceof Std.ui("Menu")&&e._dropdown.on("itemPress",function(){e.close()})),e.rendered&&e._dropdown&&e._dropdown.render(),e)}},k:function(t,e){t._button=Std.ui(e.buttonType,{text:e.text,icon:e.icon,theme:e.theme,target:e.target,href:e.href,styleType:e.styleType,iconWidth:e.iconWidth,iconHeight:e.iconHeight,fixedWidth:!0}),t._handle=Std.ui(e.buttonType,{styleType:"icon",iconWidth:16,iconHeight:16,theme:e.theme,tabIndex:null,checkable:!0,className:"StdUI_SplitButton_Hand",icon:{className:"_handleIcon --"+e.theme},fixedWidth:!0,on:{checked:function(e){e?t.open():t.close()}}}),t._group=Std.ui("ButtonGroup",{stretch:!0,appendTo:t,spacing:0,items:[t._button,t._handle]}),Std.hooker.hijack(t._button,"emit",function(e){t.emit.apply(t,e)}),t.call_opts({dropdown:null},!0)},l:function(t,e){Std.each("href target icon text iconWidth iconHeight styleType",function(t,n){e[n]=function(t){var e=this._button;return void 0===t?e[n]():(e[n](t),this)}})},support:{rule:{content:"text",children:function(t){this.dropdown(t[0])}},html:{create:function(t){var e=t.attr("std-icon"),n=t.attr("title"),o=t.children();if(isString(e)&&this.icon(e),isString(n)&&this.text(n),o&&o.length>0){var i=o[0].attr("std-ui");isString(i)&&Std.ui(i)&&this.dropdown(Std.ui.build(o[0],!1))}}}}}),Std.ui.module("SplitToolButton",{parent:"SplitButton",option:{defaultClass:"StdUI_SplitToolButton",buttonType:"ToolButton"}});