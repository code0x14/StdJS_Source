/**
    Std UI Kit Library
    http://ui.stdjs.com
	module: Button,ToolButton,ButtonGroup,ToolButtonGroup
*/
Std.ui.module("Button",{nodeName:"a",b:"widget",c:"checked mousedown mouseup click press longpress focus blur cellClick",e:{level:2,text:"Button",href:"",icon:null,cells:null,align:"center",theme:"default",target:"",defaultClass:"StdUI_Button",focusedClass:"focused",checkable:!1,checked:!1,toggleable:!0,styleType:"text",minWidth:20,minHeight:20,iconWidth:18,iconHeight:18,cellWidth:18,cellSpacing:5},h:{fixedTableLayout:!1},g:{render:function(){{var t=this;t.opts}t.initEvents(),t.initMouse()},width:function(t){var e=this,i=e.opts,n=e.boxSize.width,o=e.boxSize.extraWidth,c=e.DOMTreeLevel,s=e.DOMMap.boxTable,r=e.DOMMap.mainTable;if(e._fixedTableLayout&&(c>1?s.removeStyle("width tableLayout"):3===c&&r.removeStyle("width tableLayout"),e._fixedTableLayout=!1),c>1&&isNumber(t))if(2===c)s.width()>t-n-o&&(s.css({width:t-n-o,tableLayout:"fixed"}),e._fixedTableLayout=!0);else if(3===c&&(r.width()>t-n-o&&(r.css("tableLayout","fixed"),e._fixedTableLayout=!0),r.css("width",t-n-o),s.width()>t-n-o)){var l=Std.count(e._cells)*(i.cellWidth+i.cellSpacing),a=r.width()-l;s.css({width:a,tableLayout:"fixed"}),e._fixedTableLayout=!0}},height:function(t){var e=this,i=e.opts,n=e.boxSize,o=e.DOMMap,c=e.DOMTreeLevel;1===c&&isNumber(t)?(o.text&&o.text.lineHeight(t-n.height-n.extraHeight),o.icon&&o.icon.marginTop((t-n.height-n.extraHeight-e.opts.iconHeight)/2)):c>1&&(o.boxTable.height(t=isNumber(t)?t-n.height-n.extraHeight:t),i.iconHeight>t&&o.icon&&e.iconHeight(t))}},n:{initEvents:function(){var t=this,e=t.opts,i=!1;return t[0].on("focusin",function(n){var o=e.focusedClass;isEmpty(o)||t.addClass(o),t.emit("focus",n),i===!1&&(t.initKeyboard(),t.on("focusout",function(e){isEmpty(o)||t.removeClass("focused"),t.emit("blur",e)}),i=!0)}),t},initMouse:function(){var t=this,e=t.opts;return t[0].mouse({unselect:!0,down:function(e){t.emit("mousedown",e)},up:function(e){t.emit("mouseup",e)},click:function(i){return e.enable?(t.press(i).emit("click",i),void Std.func(e.click).call(t,i)):void i.preventDefault()},longpress:function(e){t.emit("longpress",e)}}),t},initKeyboard:function(){var t=this;return t[0].keyboard({classStatus:!0,keyCode:function(t){return 32===t.which||13===t.which?!0:void 0},down:function(t){t.preventDefault()},press:function(e){return t.opts.enable?(t.press(e),!1):void 0}}),t}},i:{DOMTreeLevel:1,initDOMTree:function(){var t=this,e=t.opts,i=t.DOMMap={},n=1,o=e.styleType,c=null,s=function(e){i.mainTable=newDom("table","_mainTable").append(i.mainTbody=newDom("tbody").append(i.mainTR1=newDom("tr").append([i.mainTD1=newDom("td").append(e)]))).appendTo(t[0])},r=function(t){c=i.boxTable=newDom("table","_buttonBox").append(i.boxTbody=newDom("tbody").append(t))},l=function(){return i.iconTD=newDom("td","_icon").append(i.icon=newDiv("_icon")),e.icon&&Std.icon.update(i.icon,e.icon,{width:e.iconWidth,height:e.iconHeight}),"textBesideIcon"===o&&i.iconTD.width(e.iconWidth).height(e.iconHeight),i.iconTD},a=function(){return i.text=newDom("td","_text").html(e.text)};isEmpty(t._cells)||(n=3),"text"===o?1==n?i.text=newDiv("_text").html(e.text).appendTo(t):r(i.tr1=newDom("tr").append(a())):"icon"===o?1==n?(t[0].append(i.icon=newDiv("_icon")),e.icon&&Std.icon.update(i.icon,e.icon,{width:e.iconWidth,height:e.iconHeight})):r(i.tr1=newDom("tr").append(l())):"textBesideIcon"===o?(r(i.tr1=newDom("tr").append([l(),a()])),1===n&&(n=2)):"textUnderIcon"===o&&(r([i.tr1=newDom("tr").append(l()),i.tr2=newDom("tr").append(a())]),1===n&&(n=2)),null!==c&&(3===n?(s(c),Std.each(t._cells,function(t,e){i.mainTR1.append(e)})):c.appendTo(t[0])),t.DOMTreeLevel=n,t.call_opts({align:"center"},!0)}},j:{checkable:function(t){return this.opt("checkable",t)},toggleable:function(t){return this.opt("toggleable",t)},target:function(t){return this.opt("target",t,function(){this[0].attr("target",t)})},href:function(t){var e=this;return this.opt("href",t,function(){isEmpty(t)?e[0].removeAttr("href"):(e.target(e.opts.target),e[0].attr("href",t))})},press:function(t){var e=this,i=e.opts;return Std.func(i.press).call(e,t),i.checkable&&(i.toggleable?e.checked(!i.checked):i.checked||e.checked(!0)),e.emit("press",t)},text:function(t){var e=this,i=e.DOMMap;return e.opt("text",t,function(){"icon"!==e.opts.styleType&&i.text.html(t)})},checked:function(t){var e=this;return e.checkable()?e.opt("checked",t,function(){e[0].toggleClass("checked",t),e.rendered&&e.emit("checked",t)}):void 0===t?e.opts.checked:e},icon:function(t){var e=this,i=e.opts,n=e.DOMMap;return e.opt("icon",t,function(){"text"!==i.styleType&&Std.icon.update(n.icon,t,{width:i.iconWidth,height:i.iconHeight})})},iconWidth:function(t){var e=this,i=e.DOMMap;return e.opt("iconWidth",t,function(){i.icon&&("textBesideIcon"===e.styleType()&&i.iconTD.width(t),Std.icon.update(i.icon,{width:t}))})},iconHeight:function(t){var e=this,i=e.DOMMap;return e.opt("iconHeight",t,function(){i.icon&&("textBesideIcon"===e.styleType()&&i.iconTD.height(t),Std.icon.update(i.icon,{height:t}))})},align:function(t){var e=this,i=e.DOMMap;return e.opt("align",t,function(){var n="0 auto";"left"===t?n="0":"right"===t&&(n="0 0 0 auto"),e.DOMTreeLevel>1?i.boxTable.css("margin",n):"icon"===e.styleType()&&i.icon.css("margin",n),e[0].css("text-align",t)})},cells:function(t){var e=this;return e._cells||(e._cells={}),void 0===t?e._cells:isString(t)?e._cells[t]||null:e},addCell:Std.func(function(t,e,i){var n=this,o=n.opts,c=e;return n._cells||(n._cells={}),t in n._cells?void 0:(Std.is.DOM(e)||(e=Std.icon.update(c=newDiv("_cell"),e,{width:null,height:null})),c.on("click",function(){n.emit("cellClick",{name:t,cell:c,data:e})}),n._cells[t]=newDom("td").append(c).css({width:o.cellWidth,paddingLeft:o.cellSpacing}),3!==n.DOMTreeLevel&&(n.DOMTreeLevel=3,n.rendered&&(n[0].clear(),n.initDOMTree(),n.resize("height"))),n.rendered&&(n.DOMMap.mainTR1.append(n._cells[t]),n.resize("width")),isFunction(i)&&c.on("click",i),e)},{each:[isObject,isArray]}),removeCell:Std.func(function(t){var e=this,i=e.opts.width,n=e._cells;n&&n[t]&&(n[t].remove(),delete n[t],e.rendered&&isNumber(i)&&e.width(i))},{each:["isArray isString"]}),styleType:function(t){var e=this,i=e.opts;return void 0===t?i.styleType:(e[0].clear(),e.removeClass("_"+i.styleType).addClass("_"+(i.styleType=t)),e.initDOMTree(),e)}},k:function(t,e){e.cells&&t.addCell(e.cells),e.href&&t.href(e.href),e.checked&&t.checked(!0),t.addClass("_"+e.styleType),t.styleType(e.styleType)},support:{rule:{content:"text"},html:{create:function(t){var e=t.attr("std-icon"),i=t.trimHTML();isEmpty(i)||this.text(i),isString(e)&&this.icon(e)}}}}),Std.ui.module("ToolButton",{nodeName:"a",b:"Button",e:{defaultClass:"StdUI_ToolButton",iconWidth:24,iconHeight:24,text:"",tabIndex:null}}),Std.ui.module("ButtonGroup",{b:"widget",e:{defaultClass:"StdUI_ButtonBox",level:2,spacing:5,items:null,tabIndex:null,stretch:!1,autoExclusive:!1,height:"auto",align:"left",styleType:"text",buttonType:"Button",buttonTheme:"default",buttonClassName:"",buttonCheckable:!1,buttonToggleable:!0,buttonFocusedClass:"focused",minWidth:25,minHeight:20,iconWidth:18,iconHeight:18},g:{width:function(){this.repaint()},enable:function(t){this._items.items(function(e,i){i.enable(t)})},destroy:function(){this.clear()},render:function(){var t=this,e=length>0?(length-1)*t.opts.spacing:0;t._items.items(function(i,n){n.height(t.height()),n.minHeight()>t.minHeight()&&t.minHeight(n.minHeight()),n.rendered||n.render(),e+=n.minWidth()}),t.minWidth(e)},remove:function(t){var e=this,i=null;isObject(t)&&(t=e.indexOf(t)),(isNumber(t)||isString(t))&&(i=e._items.items(t))&&(i.remove(),e._items.remove(t))}},j:{items:function(t,e){var i=this;return i._items.items(t,e)},spacing:function(t){return this.opt("spacing",t,function(){this.rendered&&this.repaint()})},stretch:function(t){return this.opt("stretch",t,function(){this.rendered&&this.repaint()})},autoExclusive:function(t){return this.opt("autoExclusive",t)},createButton:function(t){var e,i=this,n=this.opts;if(isWidget(t))e=t;else{var o=n.buttonType,c={theme:n.buttonTheme,className:n.buttonClassName,checkable:n.buttonCheckable,toggleable:n.buttonToggleable,focusedClass:n.buttonFocusedClass,styleType:n.styleType,iconWidth:n.iconWidth,iconHeight:n.iconHeight};isString(t)||isNumber(t)?c.text=t:isObject(t)&&(o=t.ui||o,Std.extend(c,t)),e=Std.ui(o,c)}return isWidget(e)&&e.parent(i).on("checked",function(t){var e=this;n.autoExclusive&&t&&i.items(function(t,i){e!==i&&"checkable"in i&&i.checkable()&&i.checked()&&i.checked(!1)})}),e||null},repaint:function(){var t=this,e=t.opts,i=t._items,n=t.spacing(),o=i.length,c=t.width(),s=0,r=0;if(e.stretch)for(var l=0;o>l;l++)i._list[l].fixedWidth()&&(c-=i._list[l].width(),s++);for(l=0;o>l;l++){var a=i._list[l];0==n&&(0==l?a[0].css(["border-bottom-right-radius","border-top-right-radius"],0):l==o-1?a[0].css(["border-bottom-left-radius","border-top-left-radius"],0):a[0].css("borderRadius",0)),o-1>l&&(a[0].marginRight(0==n?n-1:n),r+=n),e.stretch&&!a.fixedWidth()&&a.width((c-(o-s-1)*n)/(o-s)-1+(0==n&&o-1>l?1:0)),r+=a.minWidth()}return t[0].css("text-align",e.align),t.minWidth(r)},insert:function(t,e,i){var n=this,o=null;return null==e?(e=t,t=void 0,i=-1):void 0===i&&("number"==typeof e?(i=e,e=t,t=void 0):i=-1),(o=n.createButton(e))&&(o[0].insertTo(n,i),n._items.insert(t,o,i)),o&&n.rendered&&(o.render(),n.repaint()),n},append:Std.func(function(t,e){this.insert(t,e)},{each:[isArray]}),clear:function(){var t=this;return t._items.items(function(t,e){e.destroy()}),t._items.clear(),t}},k:function(t,e){t._items=Std.items(),isArray(e.items)&&t.append(e.items)},support:{rule:{children:"append"},html:{nodeName:["DIV"],create:function(t){var e=this.opts,i=function(t){return Std.each("styleType iconWidth iconHeight",function(i,n){n in e&&(t[n]=e[n])}),t},n=function(t){var e=t.trimHTML(),n=i({icon:t.attr("std-icon"),action:t.attr("std-action")});return isEmpty(e)||(n.text=e),Std.extend(n,Std.options.get(t))};this.append(t.children(function(t,e){var o=e.attr("std-ui");return isString(o)&&Std.ui(o)?Std.ui.build(e,!1,i({})):n(e)}))}}}}),Std.ui.module("ToolButtonGroup",{b:"ButtonGroup",e:{buttonType:"ToolButton"}});